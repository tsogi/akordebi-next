# Redirect all HTTP traffic for both domains to HTTPS
server {
    if ($host = www.dbs-group.ge) {
        return 301 https://$host$request_uri;
    } # managed by Certbot


    if ($host = dbs-group.ge) {
        return 301 https://$host$request_uri;
    } # managed by Certbot


    if ($host = www.akordebi.ge) {
        return 301 https://$host$request_uri;
    } # managed by Certbot


    if ($host = akordebi.ge) {
        return 301 https://$host$request_uri;
    } # managed by Certbot


    listen 80;
    server_name tsogi.net www.tsogi.net akordebi.ge www.akordebi.ge dbs-group.ge www.dbs-group.ge;

    # Redirect HTTP to HTTPS for all domains
    return 301 https://$host$request_uri;








}

# SSL Configuration and Proxy for tsogi.net
server {
    listen 443 ssl;
    server_name tsogi.net www.tsogi.net;

    # SSL certificates for tsogi.net (generated by Certbot)
    ssl_certificate /etc/letsencrypt/live/tsogi.net/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/tsogi.net/privkey.pem;
    include /etc/letsencrypt/options-ssl-nginx.conf;
    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem;

    # Proxy requests to the application running on port 3000 (for tsogi.net)
    location / {
        proxy_pass http://localhost:3001;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}

server {
    listen 443 ssl;
    server_name akordebi.ge www.akordebi.ge;

    # SSL certificates for tsogi.net (generated by Certbot)
    # ssl_certificate /etc/letsencrypt/live/tsogi.net/fullchain.pem;
    # ssl_certificate_key /etc/letsencrypt/live/tsogi.net/privkey.pem;
    # include /etc/letsencrypt/options-ssl-nginx.conf;
    # ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem;

    # Proxy requests to the application running on port 3000 (for tsogi.net)
    location / {
        proxy_pass http://localhost:3002;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }

    ssl_certificate /etc/letsencrypt/live/akordebi.ge/fullchain.pem; # managed by Certbot
    ssl_certificate_key /etc/letsencrypt/live/akordebi.ge/privkey.pem; # managed by Certbot

}

server {
    listen 443 ssl;
    server_name dbs-group.ge www.dbs-group.ge;

    location / { proxy_pass http://localhost:3003;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }

    ssl_certificate /etc/letsencrypt/live/dbs-group.ge/fullchain.pem; # managed by Certbot
    ssl_certificate_key /etc/letsencrypt/live/dbs-group.ge/privkey.pem; # managed by Certbot

}

server {
    listen 443 ssl;
    server_name build365.ge www.build365.ge;

    location / {
        proxy_pass http://localhost:3004;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }

    ssl_certificate /etc/letsencrypt/live/build365.ge/fullchain.pem; # managed by Certbot
    ssl_certificate_key /etc/letsencrypt/live/build365.ge/privkey.pem; # managed by Certbot

}

server {
    listen 443 ssl;
    server_name chords365.com www.chords365.com;

    location / {
        proxy_pass http://localhost:3005;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }

    ssl_certificate /etc/letsencrypt/live/chords365.com/fullchain.pem; # managed by Certbot
    ssl_certificate_key /etc/letsencrypt/live/chords365.com/privkey.pem; # managed by Certbot

}

server {
    listen 443 ssl;
    server_name alarm.ge www.alarm.ge;

    location / {
        proxy_pass http://localhost:3006;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
	proxy_read_timeout 600;  # 10 minutes
        proxy_connect_timeout 600;  # 10 minutes
        proxy_send_timeout 600;  # 10 
	send_timeout 600;
    }

    ssl_certificate /etc/letsencrypt/live/alarm.ge/fullchain.pem; # managed by Certbot
    ssl_certificate_key /etc/letsencrypt/live/alarm.ge/privkey.pem; # managed by Certbot

}

server {
    listen 443 ssl;
    server_name admin.tsogi.ge www.admin.tsogi.ge;

    location / {
        proxy_pass http://localhost:3007;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
	proxy_read_timeout 600;  # 10 minutes
        proxy_connect_timeout 600;  # 10 minutes
        proxy_send_timeout 600;  # 10 
	send_timeout 600;
    }

    ssl_certificate /etc/letsencrypt/live/admin.tsogi.ge/fullchain.pem; # managed by Certbot
    ssl_certificate_key /etc/letsencrypt/live/admin.tsogi.ge/privkey.pem; # managed by Certbot

}
